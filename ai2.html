<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Titan Omnipotent OS - Genesis Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/tokyo-night-dark.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Plus+Jakarta+Sans:wght@300;500;800&display=swap');
        
        :root { --primary: #3b82f6; --accent: #10b981; --bg: #030712; }
        body { background: var(--bg); color: #e5e7eb; font-family: 'Plus Jakarta Sans', sans-serif; height: 100vh; overflow: hidden; }

        .app-container { display: grid; grid-template-columns: 280px 1fr 320px; height: 100vh; padding: 12px; gap: 12px; }
        .panel { background: rgba(17, 24, 39, 0.7); backdrop-filter: blur(16px); border: 1px solid rgba(255,255,255,0.05); border-radius: 24px; display: flex; flex-direction: column; }
        
        /* Message Area */
        #chat-stream::-webkit-scrollbar { width: 4px; }
        #chat-stream::-webkit-scrollbar-thumb { background: #1f2937; border-radius: 10px; }
        
        .bubble { padding: 1.25rem; border-radius: 18px; max-width: 90%; font-size: 0.95rem; line-height: 1.6; }
        .ai-msg { background: rgba(31, 41, 55, 0.5); border: 1px solid rgba(59, 130, 246, 0.2); }
        .user-msg { background: var(--primary); color: white; margin-left: auto; }

        /* Audio Visualizer */
        .v-bar { width: 3px; height: 4px; background: var(--primary); border-radius: 4px; transition: 0.2s; }
        .is-playing .v-bar { animation: bounce 0.6s infinite alternate; }
        @keyframes bounce { from { height: 4px; } to { height: 24px; } }

        code { font-family: 'JetBrains Mono', monospace !important; }
    </style>
</head>
<body>

<div class="app-container">
    <aside class="panel p-6 gap-6">
        <div>
            <h3 class="text-[10px] font-black tracking-widest text-blue-500 uppercase mb-4">Neural Media</h3>
            <div class="bg-black/40 rounded-2xl p-4 border border-white/5">
                <div class="flex items-center gap-4 mb-4">
                    <div id="v-container" class="flex items-end gap-1 h-6">
                        <div class="v-bar"></div><div class="v-bar"></div><div class="v-bar"></div><div class="v-bar"></div>
                    </div>
                    <span id="track-name" class="text-xs font-bold truncate">Deep Work Audio</span>
                </div>
                <div class="flex gap-2">
                    <button onclick="Core.audio.play('https://streaming.radio.co/s647091630/listen')" class="flex-1 py-2 bg-blue-600/10 text-blue-400 rounded-lg text-[10px] font-bold border border-blue-500/20 hover:bg-blue-600 hover:text-white transition">PLAY</button>
                    <button onclick="Core.audio.stop()" class="flex-1 py-2 bg-red-600/10 text-red-400 rounded-lg text-[10px] font-bold border border-red-500/20 hover:bg-red-600 hover:text-white transition">STOP</button>
                </div>
            </div>
        </div>

        <div class="flex-1 overflow-hidden flex flex-col">
            <h3 class="text-[10px] font-black tracking-widest text-gray-500 uppercase mb-4">Quick Tools</h3>
            <div class="space-y-2 overflow-y-auto pr-2">
                <div class="p-3 bg-white/5 rounded-xl border border-white/5 hover:border-blue-500 cursor-pointer transition">
                    <p class="text-[11px] font-bold">Code Debugger</p>
                    <p class="text-[9px] text-gray-500 italic">Phân tích lỗi lập trình</p>
                </div>
                <div class="p-3 bg-white/5 rounded-xl border border-white/5 hover:border-green-500 cursor-pointer transition">
                    <p class="text-[11px] font-bold">Data Visualizer</p>
                    <p class="text-[9px] text-gray-500 italic">Chuyển số liệu thành biểu đồ</p>
                </div>
                <div class="p-3 bg-white/5 rounded-xl border border-white/5 hover:border-purple-500 cursor-pointer transition">
                    <p class="text-[11px] font-bold">Translator Mode</p>
                    <p class="text-[9px] text-gray-500 italic">Dịch thuật đa ngôn ngữ</p>
                </div>
            </div>
        </div>
    </aside>

    <main class="panel flex flex-col relative">
        <header class="h-16 border-b border-white/5 px-8 flex justify-between items-center bg-white/5">
            <div class="flex items-center gap-3">
                <div class="w-2 h-2 bg-blue-500 rounded-full shadow-[0_0_10px_#3b82f6]"></div>
                <span class="text-sm font-black tracking-tighter">TITAN OMNIPOTENT CORE</span>
            </div>
            <input id="api-key" type="password" placeholder="API Key" class="bg-black/50 border border-white/10 rounded-full px-4 py-1.5 text-[10px] w-48 focus:border-blue-500 outline-none">
        </header>

        <div id="chat-stream" class="flex-1 overflow-y-auto p-8 space-y-6">
            <div class="bubble ai-msg">
                <h4 class="text-blue-400 font-bold mb-2">Hệ thống đã sẵn sàng.</h4>
                <p class="text-sm text-gray-300">Tất cả module đã được nạp: Lập trình, Phân tích dữ liệu, Âm thanh tập trung và Tìm kiếm. Bạn muốn thực hiện nhiệm vụ gì?</p>
            </div>
        </div>

        <div class="p-6 bg-gradient-to-t from-gray-900">
            <div class="max-w-4xl mx-auto flex items-end gap-3 bg-gray-800/50 p-2 rounded-3xl border border-white/10 focus-within:border-blue-500 transition">
                <textarea id="user-input" rows="1" class="flex-1 bg-transparent border-none outline-none p-4 text-sm resize-none" placeholder="Nhập yêu cầu..."></textarea>
                <button onclick="Core.ai.ask()" class="w-12 h-12 bg-blue-600 rounded-2xl flex items-center justify-center hover:bg-blue-500 active:scale-95 transition">
                    <i class="fa-solid fa-paper-plane text-white"></i>
                </button>
            </div>
        </div>
    </main>

    <aside class="panel p-6 gap-6">
        <h3 class="text-[10px] font-black tracking-widest text-gray-500 uppercase">Analysis Logs</h3>
        <div id="logs" class="bg-black/30 rounded-2xl p-4 flex-1 font-mono text-[9px] text-green-500/70 overflow-y-auto">
            > Neural Engine initialized...<br>
            > Audio context secured...<br>
            > Memory allocation 100%...<br>
            > System waiting for prompt...
        </div>
        
        <div class="bg-blue-600/5 p-4 rounded-2xl border border-blue-500/20">
            <div class="flex justify-between text-[10px] mb-2 font-bold"><span>CPU USAGE</span><span id="cpu">12%</span></div>
            <div class="h-1 bg-gray-800 rounded-full overflow-hidden"><div class="w-1/4 h-full bg-blue-500"></div></div>
        </div>
    </aside>
</div>

<audio id="master-audio" crossorigin="anonymous"></audio>

<script>
const Core = {
    audio: {
        el: document.getElementById('master-audio'),
        vBox: document.getElementById('v-container'),
        play(url) {
            this.el.src = url;
            this.el.play();
            this.vBox.classList.add('is-playing');
            Core.log("Audio Stream: Active");
        },
        stop() {
            this.el.pause();
            this.vBox.classList.remove('is-playing');
            Core.log("Audio Stream: Terminated");
        }
    },

    ai: {
        history: [],
        async ask() {
            const input = document.getElementById('user-input');
            const key = document.getElementById('api-key').value;
            if(!input.value || !key) return alert("Cần nhập Key và Câu hỏi!");

            const prompt = input.value;
            input.value = '';
            Core.ui.append('user', prompt);
            Core.log("AI Task: Processing request...");

            const loader = Core.ui.append('ai', '<div class="flex gap-1"><span class="w-1 h-1 bg-blue-500 rounded-full animate-bounce"></span><span class="w-1 h-1 bg-blue-500 rounded-full animate-bounce [animation-delay:0.2s]"></span><span class="w-1 h-1 bg-blue-500 rounded-full animate-bounce [animation-delay:0.4s]"></span></div>');

            try {
                const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                    method: "POST",
                    headers: { "Authorization": `Bearer ${key}`, "Content-Type": "application/json" },
                    body: JSON.stringify({
                        model: "llama-3.3-70b-versatile",
                        messages: [{role: "system", content: "Bạn là Titan AI Omnipotent. Trình bày cực kỳ chuyên nghiệp bằng Markdown, code, và bảng biểu."}, ...this.history, {role: "user", content: prompt}]
                    })
                });
                const data = await res.json();
                const text = data.choices[0].message.content;
                loader.innerHTML = marked.parse(text);
                this.history.push({role: "user", content: prompt}, {role: "assistant", content: text});
                document.querySelectorAll('pre code').forEach(el => hljs.highlightElement(el));
                Core.log("AI Task: Success");
            } catch (e) {
                loader.innerHTML = "Lỗi hệ thống Core.";
                Core.log("AI Task: Error Failed");
            }
        }
    },

    ui: {
        append(role, text) {
            const box = document.getElementById('chat-stream');
            const div = document.createElement('div');
            div.className = `bubble ${role === 'user' ? 'user-msg' : 'ai-msg'} prose prose-invert`;
            div.innerHTML = text;
            box.appendChild(div);
            box.scrollTo(0, box.scrollHeight);
            return div;
        }
    },

    log(msg) {
        const logBox = document.getElementById('logs');
        logBox.innerHTML += `<br>> ${msg}`;
        logBox.scrollTo(0, logBox.scrollHeight);
    }
};

document.getElementById('user-input').oninput = function() {
    this.style.height = 'auto';
    this.style.height = this.scrollHeight + 'px';
};
</script>
</body>
</html>